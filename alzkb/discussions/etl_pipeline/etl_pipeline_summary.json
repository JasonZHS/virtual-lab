{
  "topic": "ETL Pipeline Development",
  "timestamp": "2025-12-24T19:52:51.129771",
  "summary_text": "**Principal Investigator (PI)**\n\n\"Team, this session has been exemplary. We have successfully transformed a generic data aggregation plan into a rigorous scientific instrument. By addressing the 'Risk Allele Trap,' enforcing 'Curated-Only' filters, and designing for 'RAG-Readiness,' we have ensured that AlzKB will be a source of truth, not noise.\n\nHere is the **Official ETL Design Specification (v1.0)** based on our consensus. This document now governs the engineering phase.\n\n---\n\n### **FINAL REVISED ETL SPECIFICATION**\n\n#### **1. Priority & Execution Order**\n1.  **Ensembl (The Backbone):** Establish the `Master_Gene_Index` to resolve Symbols/Entrez/UniProt to ENSG IDs.\n2.  **GWAS Catalog (Genetic Foundation):** Establish the risk variant landscape with strict directionality.\n3.  **DisGeNET & ChEMBL (Context):** Add curated phenotypes and high-affinity drug targets.\n4.  **Reactome (Mechanism):** Ingest full human hierarchy for pathway traversal.\n\n#### **2. Source-to-Ontology Mapping & Filters**\n*All ingestions utilize the 'Medallion' architecture (Bronze Raw $\\to$ Silver Norm $\\to$ Gold Graph).*\n\n| Source | Raw Fields (Critical) | Target Class & Property | Canonical ID Strategy | **CRITICAL ETL LOGIC / FILTERS** |\n| :--- | :--- | :--- | :--- | :--- |\n| **Ensembl** | `Gene Stable ID`, `Synonyms` | `:Gene` | `ENSG_ID` | Create `Master_Gene_Index`. Map all synonyms. |\n| **GWAS Catalog** | `SNPS`, `STRONGEST SNP-RISK ALLELE`, `P-VALUE`, `MAPPED_GENE` | `:Allele`, `:GwasAssociation` | `rsID` | **1.** `p < 5e-8`. <br>**2.** Parse `Risk Allele` (e.g., 'rs123-A') $\\to$ `alzkb:effect_allele`. <br>**3.** Split `MAPPED_GENE` on comma $\\to$ `alzkb:associated_gene_context`. |\n| **DisGeNET** | `geneId`, `score`, `source` | `:HypothesisAssociation` | `ENSG_ID` (via map) | **1.** Filter: **Curated Sources Only** (UniProt, CTD, PsyGeNET). Exclude BeFree/Text-mining. <br>**2.** `score > 0.5`. |\n| **ChEMBL** | `molecule_chembl_id`, `pchembl_value` | `:Drug`, `:Interaction` | `CHEMBL_ID` | **1.** Filter: `pChEMBL_value > 6` (High affinity only). <br>**2.** Drop records with missing pChEMBL (do not convert units manually). |\n| **Reactome** | `PhysicalEntity`, `Pathway`, `comment` | `:Protein`, `:Pathway` | `UniProt`, `ReactomeID` | **1.** Ingest full hierarchy. <br>**2.** Extract text descriptions $\\to$ `dcterms:description` for RAG. |\n\n#### **3. Entity Resolution Strategy**\n*   **The \"Splitter\" Rule:** Comma-separated genes in GWAS (intergenic variants) are split into multiple `:associated_gene_context` edges.\n*   **The \"One-Strike\" Policy:**\n    *   Any entity (Gene/Drug) that cannot be resolved to a canonical ID (ENSG or CHEMBL) using the Master Index is sent to the **Dead Letter Queue (DLQ)**.\n    *   Ambiguous synonyms (mapping to >1 ENSG) are blacklisted.\n*   **RAG Enrichment:**\n    *   Every `:HypothesisAssociation` gets a computed `alzkb:citation_string`: `\"{Source}: {StudyID} (n={N}, p={P}, OR={OR}, Allele={RiskAllele})\"` for hallucination-free citation.\n\n#### **4. Validation & Quality Gates**\n*   **Gate 1 (Ingest):** Schema validation (Pandera).\n*   **Gate 2 (Logic):** Row-level filters (p-value, pChEMBL, Curated-Source).\n*   **Gate 3 (Graph):** **SHACL Validation** running on the Gold Layer.\n    *   *Constraint:* `:GwasAssociation` must have `alzkb:effect_allele` matching regex `^[ACGT]+$`.\n*   **Gate 4 (Scientific Benchmark):**\n    *   **The ATN Test:** Pipeline fails if `APOE e4` (rs429358-C) is not present as a **RISK** factor (OR > 1.0) with High Confidence.\n\n---\n\n**Next Steps:**\n*   **KG Engineer:** Initialize the Airflow DAGs for Phase 1 (Ensembl).\n*   **Ontologist:** Commit the `alzkb-ontology-v2.ttl` with the new properties (`effect_allele`, `associated_gene_context`).\n*   **Validation Scientist:** Write the ATN Cypher test suite.\n\nMeeting adjourned. Let's build the graph.\"",
  "summary_structured": {
    "decisions": [
      "Adopted Medallion Architecture (Bronze/Silver/Gold) for the ETL pipeline.",
      "Mandated parsing of 'STRONGEST SNP-RISK ALLELE' in GWAS data to strictly define risk vs. protective directionality.",
      "Downgraded GWAS intergenic mappings to use 'alzkb:associated_gene_context' rather than direct causal links.",
      "Restricted DisGeNET ingestion to Curated sources only (excluding BeFree/text-mining) with Score > 0.5.",
      "Restricted ChEMBL ingestion to high-affinity interactions with pChEMBL > 6.",
      "Approved ingestion of the full human Reactome hierarchy with mandatory text description extraction for RAG.",
      "Required injection of pre-formatted 'alzkb:citation_string' into all HypothesisAssociation nodes.",
      "Established the 'ATN Benchmark' (specifically APOE e4 risk confirmation) as the fatal-error integration test."
    ],
    "action_items": [
      "Initialize Airflow DAGs starting with Ensembl Master Index (KG Engineer)",
      "Implement Splitter Function and Risk Allele Parser for GWAS pipelines (KG Engineer)",
      "Update ontology schema to include 'alzkb:effect_allele' and 'alzkb:associated_gene_context' (Ontologist)",
      "Develop Cypher test suite for ATN Benchmark validation (Validation Scientist)"
    ],
    "status": "COMPLETE",
    "key_context": "The ETL design phase concluded with a scientifically rigorous specification prioritizing precision over recall. Critical logic was added to handle genetic directionality (risk alleles), filter out low-confidence text-mining data, and prepare the graph for RAG via citation string injection."
  }
}